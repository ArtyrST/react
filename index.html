<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–°–ø–∏—Å–æ–∫ —Å–ø—Ä–∞–≤ ‚Äî React</title>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    body {
      font-family: Arial;
      background: #f4f6f8;
    }
    .app {
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    input, textarea, select, button {
      padding: 8px;
      width: 100%;
      margin-bottom: 10px;
    }
    .task {
      background: white;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
    }
    .low { border-left: 6px solid green; }
    .medium { border-left: 6px solid orange; }
    .high { border-left: 6px solid red; }
    .controls {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 15px 0;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

function App() {
  const emptyTask = {
    id: null,
    title: "",
    desc: "",
    datetime: "",
    tags: "",
    priority: "medium",
    project: ""
  };

  const [tasks, setTasks] = useState([]);
  const [task, setTask] = useState(emptyTask);
  const [search, setSearch] = useState("");
  const [filter, setFilter] = useState("all");

  useEffect(() => {
    const saved = JSON.parse(localStorage.getItem("tasks"));
    if (saved) setTasks(saved);
  }, []);

  useEffect(() => {
    localStorage.setItem("tasks", JSON.stringify(tasks));
  }, [tasks]);

  const saveTask = () => {
    if (!task.title) return;

    if (task.id) {
      setTasks(tasks.map(t => t.id === task.id ? task : t));
    } else {
      setTasks([...tasks, { ...task, id: Date.now() }]);
    }
    setTask(emptyTask);
  };

  const editTask = (t) => setTask(t);

  const deleteTask = (id) =>
    setTasks(tasks.filter(t => t.id !== id));

  const filteredTasks = tasks
    .filter(t => {
      const q = search.toLowerCase();
      return (
        t.title.toLowerCase().includes(q) ||
        t.desc.toLowerCase().includes(q) ||
        t.tags.toLowerCase().includes(q) ||
        t.priority.includes(q)
      );
    })
    .filter(t => {
      if (filter === "all") return true;
      const now = new Date();
      const date = new Date(t.datetime);
      const diff = (date - now) / (1000 * 60 * 60 * 24);

      if (filter === "day") return diff >= 0 && diff < 1;
      if (filter === "week") return diff >= 0 && diff <= 7;
      if (filter === "month") return date.getMonth() === now.getMonth();
    });

  return (
    <div className="app">
      <h1>üìù –°–ø–∏—Å–æ–∫ —Å–ø—Ä–∞–≤</h1>

      <input placeholder="–ù–∞–∑–≤–∞ —Å–ø—Ä–∞–≤–∏"
        value={task.title}
        onChange={e => setTask({...task, title: e.target.value})} />

      <input type="datetime-local"
        value={task.datetime}
        onChange={e => setTask({...task, datetime: e.target.value})} />

      <textarea placeholder="–û–ø–∏—Å"
        value={task.desc}
        onChange={e => setTask({...task, desc: e.target.value})} />

      <input placeholder="–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∫–æ–º—É)"
        value={task.tags}
        onChange={e => setTask({...task, tags: e.target.value})} />

      <select value={task.priority}
        onChange={e => setTask({...task, priority: e.target.value})}>
        <option value="low">–ù–∏–∑—å–∫–∏–π</option>
        <option value="medium">–°–µ—Ä–µ–¥–Ω—ñ–π</option>
        <option value="high">–í–∏—Å–æ–∫–∏–π</option>
      </select>

      <input placeholder="–ü—Ä–æ—î–∫—Ç"
        value={task.project}
        onChange={e => setTask({...task, project: e.target.value})} />

      <button onClick={saveTask}>
        {task.id ? "–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏" : "–î–æ–¥–∞—Ç–∏ —Å–ø—Ä–∞–≤—É"}
      </button>

      <div className="controls">
        <select onChange={e => setFilter(e.target.value)}>
          <option value="all">–£—Å—ñ</option>
          <option value="day">–ù–∞ –¥–µ–Ω—å</option>
          <option value="week">–ù–∞ —Ç–∏–∂–¥–µ–Ω—å</option>
          <option value="month">–ù–∞ –º—ñ—Å—è—Ü—å</option>
        </select>

        <input placeholder="–ü–æ—à—É–∫..."
          onChange={e => setSearch(e.target.value)} />
      </div>

      {filteredTasks.map(t => (
        <div key={t.id} className={`task ${t.priority}`}>
          <h3>{t.title}</h3>
          <small>{t.datetime}</small>
          <p>{t.desc}</p>
          <p>üè∑ {t.tags}</p>
          <p>üìÅ –ü—Ä–æ—î–∫—Ç: {t.project || "–Ω–µ–º–∞—î"}</p>

          <button onClick={() => editTask(t)}>‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
          <button onClick={() => deleteTask(t.id)}>üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
      ))}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>

</body>
</html>
